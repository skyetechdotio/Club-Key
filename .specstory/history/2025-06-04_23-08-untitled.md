<!-- Generated by SpecStory -->

# Untitled (2025-06-04 19:08:23)

_**User**_

"We want to improve the user experience after a new user registers and email verification is required. Instead of just a toast, we want to display a more prominent centered message or modal.
Current Flow:
User fills RegisterForm.
RegisterForm calls auth.register().
auth.register() in AuthContext calls supabase.auth.signUp().
If successful and email verification is needed, RegisterForm shows a toast and calls its onSuccess prop (which is closeAuthModal in App.tsx), closing the main AuthModal.
Desired Changes:
frontend/src/context/auth-context.tsx (register function):
Modify the register function. If supabase.auth.signUp() is successful and authData.session is null (indicating email verification is pending), the function should return an object like { user: authData.user, emailVerificationPending: true, email: data.email }. If the session is immediately available, return { user: authData.user, emailVerificationPending: false, email: data.email }.
frontend/src/components/auth/register-form.tsx (onSubmit function):
When await register(...) completes, check the result.emailVerificationPending flag.
Modify the onSuccess prop definition in RegisterFormProps to accept an optional argument: onSuccess: (result?: { emailVerificationPending?: boolean, email?: string }) => void;.
Call onSuccess({ emailVerificationPending: result.emailVerificationPending, email: data.email }) instead of just onSuccess().
The toast shown within RegisterForm for successful registration can be kept or removed if the new modal is sufficient.
frontend/src/App.tsx:
Add new state: const [showCheckEmailModal, setShowCheckEmailModal] = useState(false); and const [emailForVerification, setEmailForVerification] = useState<string | null>(null);.
Modify the closeAuthModal function (which is passed as onSuccess to RegisterForm via AuthModal):
Generated typescript
const closeAuthModal = (result?: { emailVerificationPending?: boolean, email?: string }) => {
  setIsAuthModalOpen(false); // Close the main AuthModal
  if (result?.emailVerificationPending && result.email) {
    setEmailForVerification(result.email);
    setShowCheckEmailModal(true); // Trigger the new "Check Email" modal
  }
};
Use code with caution.
TypeScript
Render a new modal component (e.g., <CheckEmailModal />) conditionally based on showCheckEmailModal.
Create frontend/src/components/auth/CheckEmailModal.tsx:
This new component should display a centered message.
Props: isOpen: boolean, onClose: () => void, email: string | null.
Content:
Title: "Verify Your Email"
Message: "Registration successful! We've sent a verification link to props.email. Please check your inbox (and spam folder) and click the link to activate your account before logging in."
Buttons:
"Okay, I'll check my email" (calls props.onClose).
(Optional MVP+) "Resend Verification Email" (if clicked, calls supabase.auth.resend({ type: 'signup', email: props.email }) and shows a toast).
Please provide the diffs/new content for:
frontend/src/context/auth-context.tsx (the register function and its return type).
frontend/src/components/auth/register-form.tsx (the onSuccess prop type and how it's called).
frontend/src/App.tsx (new state variables, modified closeAuthModal, and rendering of the new modal).
The complete code for the new frontend/src/components/auth/CheckEmailModal.tsx."

---

_**Assistant**_



---

